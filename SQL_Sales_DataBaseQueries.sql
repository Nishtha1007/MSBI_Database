create database SALES_INFO


CREATE TABLE  dbo.SALES_PERSON 
   (	
    "SALESPERSON_ID" CHAR(6) NOT NULL PRIMARY KEY, 
	"SALESPERSON_NAME" CHAR(40), 
	"WORKING_AREA" CHAR(35), 
	"COMMISSION" DECIMAL(10,3), 
	"PHONE_NO" CHAR(15), 
	"CONTINENT" VARCHAR(25) 
	 );


INSERT INTO SALES_PERSON VALUES ('A001', 'Rama', 'Delhi', '0.175', '071-25814763', 'IN');
INSERT INTO SALES_PERSON VALUES ('A002', 'Alan ', 'London', '0.153', '074-12458969', 'GB');
INSERT INTO SALES_PERSON VALUES ('A003', 'Reford', 'New York', '0.132', '045-25874365', 'US');
INSERT INTO SALES_PERSON VALUES ('A004', 'Chunky Kumar', 'Delhi', '0.135', '067-45625874', 'IN');
INSERT INTO SALES_PERSON VALUES ('A005', 'SantaClaus', 'Chennai', '0.134', '037-22388644', 'IN');
INSERT INTO SALES_PERSON VALUES ('A006', 'Luca', 'San Jose', '0.132', '034-52981425', 'US');
INSERT INTO SALES_PERSON VALUES ('A007', 'Wolverine', 'Brisban', '0.133', '033-21447739', '');
INSERT INTO SALES_PERSON VALUES ('A008', 'Hulk', 'Delhi', '0.134', '032-12346674', 'TR');
INSERT INTO SALES_PERSON VALUES ('A009', 'Mendi', 'Mumbai', '0.131', '022-12358964', 'IN');
INSERT INTO SALES_PERSON VALUES ('A010', 'McDonald', 'London', '0.135', '071-22255588', 'GB');
INSERT INTO SALES_PERSON VALUES ('A011', 'IvanJames', 'Torento', '0.135', '012-22544166', 'CA');
INSERT INTO SALES_PERSON VALUES ('A012', 'Benja', 'Brazil', '0.123', '008-22536178', 'BR');

INSERT INTO SALES_PERSON VALUES ('A013', 'Rama1', 'Cambodia', '0.175', '071-25814763', 'KH');
INSERT INTO SALES_PERSON VALUES ('A014', 'Alan1 ', 'London', '0.153', '074-12458969', 'GB');
INSERT INTO SALES_PERSON VALUES ('A015', 'Reford1', 'New York', '0.132', '045-25874365', 'US');
INSERT INTO SALES_PERSON VALUES ('A016', 'Chunky Kumar1', 'Cambodia', '0.135', '067-45625874', 'KH');
INSERT INTO SALES_PERSON VALUES ('A017', 'SantaClaus1', 'Chile', '0.134', '037-22388644', 'CL');
INSERT INTO SALES_PERSON VALUES ('A018', 'Luca1', 'San Jose', '0.132', '034-52981425', 'US');
INSERT INTO SALES_PERSON VALUES ('A019', 'Wolverine1', 'Brisban', '0.133', '033-21447739', '');
INSERT INTO SALES_PERSON VALUES ('A020', 'Hulk1', 'Cambodia', '0.134', '032-12346674', 'KH');
INSERT INTO SALES_PERSON VALUES ('A021', 'Mendi1', 'Mumbai', '0.131', '022-12358964', 'IN');
INSERT INTO SALES_PERSON VALUES ('A022', 'McDonald1', 'London', '0.135', '071-22255588', 'GB');
INSERT INTO SALES_PERSON VALUES ('A023', 'IvanJames1', 'Torento', '0.135', '012-22544166', 'CA');
INSERT INTO SALES_PERSON VALUES ('A024', 'Benja1', 'Brazil', '0.123', '008-22536178', 'BR');



CREATE TABLE  "CUSTOMER" 
   ( "CUST_ID" VARCHAR(6) NOT NULL PRIMARY KEY, 
	"FULL_NAME" VARCHAR(40) NOT NULL, 
	"CURRENT_ADDRESS" VARCHAR(35) NOT NULL, 
	"CUST_CITY" CHAR(35), 
	"CUST_COUNTRY" VARCHAR(20) NOT NULL, 
	"CUST_POINTS" INT, 
	"OPENING_AMT" DECIMAL(12,2) NOT NULL, 
	"RECEIVE_AMT" DECIMAL(12,2) NOT NULL, 
	"PAYMENT_AMT" DECIMAL(12,2) NOT NULL, 
	"OUTSTANDING_AMT" DECIMAL(12,2) NOT NULL, 
	"PHONE_NO" VARCHAR(17) NOT NULL, 
	"SALESPERSON_ID" CHAR(6) NOT NULL REFERENCES dbo.SALES_PERSON
);   



INSERT INTO CUSTOMER VALUES ('C00001', 'Sherlock Holmes', 'Chad', 'Chad', 'TD', '2', '6000.00', '6000.00', '7000.00', '4000.00', 'BBBBBBB', 'A003');
INSERT INTO CUSTOMER VALUES ('C00002', 'Micheal Jackson', 'New York', 'New York', 'US', '2', '3000.00', '6000.00', '2000.00', '6000.00', 'CCCCCCC', 'A008');
INSERT INTO CUSTOMER VALUES ('C00003', 'Albert Einstein', 'New York', 'New York', 'US', '3', '6000.00', '7000.00', '6000.00', '6000.00', 'BBBBSBB', 'A008');
INSERT INTO CUSTOMER VALUES ('C00004', 'Ravindran Nath', 'Bangalore', 'Bangalore', 'IN', '2', '6000.00', '7000.00', '4000.00', '8000.00', 'AVAVAVA', 'A010');
INSERT INTO CUSTOMER VALUES ('C00005', 'Tim Cook', 'Chad', 'Chad', 'TD', '2', '4000.00', '3000.00', '7000.00', '6000.00', 'FSDDSDF', 'A006');
INSERT INTO CUSTOMER VALUES ('C00006', 'Stuart Little', 'Chad', 'Chad', 'TD', '5', '6000.00', '8000.00', '3000.00', '55000.00', 'GFSGERS', 'A003');
INSERT INTO CUSTOMER VALUES ('C00007', 'Robert Bolt', 'New York', 'New York', 'USA', '3', '6000.00', '7000.00', '3000.00', '3000.00', 'DDNRDRH', 'A008');
INSERT INTO CUSTOMER VALUES ('C00008', 'James Fleming', 'Brisban', 'Brisban', 'AU', '2', '7000.00', '7000.00', '3000.00', '6000.00', 'NHBGVFC', 'A006');
INSERT INTO CUSTOMER VALUES ('C00009', 'Jacks Sparrow', 'Brisban', 'Brisban', 'AU', '5', '7000.00', '7000.00', '7000.00', '7000.00', 'WERTGDF', 'A006');
INSERT INTO CUSTOMER VALUES ('C00010', 'Yearannaidu Little', 'Chennai', 'Chennai', 'IN', '5', '8000.00', '7000.00', '7000.00', '8000.00', 'ZZZZBFV', 'A001');
INSERT INTO CUSTOMER VALUES ('C00011', 'Siciy Mathews', 'Mumbai', 'Mumbai', 'IN', '5', '7000.00', '55000.00', '7000.00', '55000.00', '547-26836352', 'A002');
INSERT INTO CUSTOMER VALUES ('C00012', 'Rosi Lames', 'Chennai', 'Chennai', 'IN', '5', '7000.00', '55000.00', '3000.00', '3000.00', 'GHRDWSD', 'A001');
INSERT INTO CUSTOMER VALUES ('C00013', 'Avi Ken', 'Mumbai', 'Mumbai', 'IN', '2', '7000.00', '55000.00', '3000.00', '3000.00', '553-52346678','A002');
INSERT INTO CUSTOMER VALUES ('C00014', 'Winston San', 'Brisban', 'Brisban', 'AU', '5', '6000.00', '8000.00', '7000.00', '6000.00', 'AAAAAAA', 'A006');
INSERT INTO CUSTOMER VALUES ('C00015', 'Karl Loki', 'Chad', 'Chad', 'TD', '0', '4000.00', '6000.00', '7000.00', '3000.00', 'AAAABAA', 'A006');
INSERT INTO CUSTOMER VALUES ('C00016', 'Sydenton Lol', 'Torento', 'Torento', 'CA', '5', '50000.00', '7000.00', '6000.00', '55000.00', 'DDDDDDD', 'A004');
INSERT INTO CUSTOMER VALUES ('C00017', 'Charles Dickens', 'Hampshair', 'Hampshair', 'UK', '3', '6000.00', '4000.00', '6000.00', '6000.00', 'MMMMMMM', 'A003');
INSERT INTO CUSTOMER VALUES ('C00018', 'SrJunior Kev', 'Bangalore', 'Bangalore', 'IN', '2', '8000.00', '4000.00', '3000.00', '3000.00', 'AAAAAAB', 'A007');
INSERT INTO CUSTOMER VALUES ('C00019', 'Steven Jobs', 'San Jose', 'San Jose', 'US', '5', '6000.00', '7000.00', '3000.00', '3000.00', 'KRFYGJK', 'A015');
INSERT INTO CUSTOMER VALUES ('C00020', 'Karolin North', 'Torento', 'Torento', 'CA', '5', '7000.00', '7000.00', '3000.00', '6000.00', 'HJKORED', 'A004');
INSERT INTO CUSTOMER VALUES ('C00021', 'Martin Salandra', 'Torento', 'Torento', 'CA', '2', '8000.00', '7000.00', '7000.00', '8000.00', 'MJYURFD', 'A004');
INSERT INTO CUSTOMER VALUES ('C00022', 'Ramesh Justin', 'Mumbai', 'Mumbai', 'IN', '3', '8000.00', '7000.00', '3000.00', '52000.00', 'Phone No', 'A002');
INSERT INTO CUSTOMER VALUES ('C00023', 'Ran Gone', 'Bangalore', 'Bangalore', 'IN', '2', '8000.00', '55000.00', '7000.00', '52000.00', 'AAAATGF', 'A005');
INSERT INTO CUSTOMER VALUES ('C00024', 'Kim Possible', 'Bangalore', 'Bangalore', 'IN', '2', '8000.00', '55000.00', '7000.00', '52000.00', 'JRTVFDD', 'A007');
INSERT INTO CUSTOMER VALUES ('C00025', 'Sundar Bhaiya', 'Chennai', 'Chennai', 'IN', '3', '7000.00', '55000.00', '7000.00', '55000.00', 'PPHGRTS', 'A024');



CREATE TABLE  "ORDERS" 
   (
        "ORDER_NO" INT NOT NULL PRIMARY KEY, 
	"AMOUNT" DECIMAL(12,2) NOT NULL, 
	"PAID_AMOUNT" DECIMAL(12,2) NOT NULL, 
	"DATE" DATE NOT NULL, 
	"CUST_ID" VARCHAR(6) NOT NULL REFERENCES dbo.CUSTOMER, 
	"SALESPERSON_ID" CHAR(6) NOT NULL REFERENCES  dbo.SALES_PERSON, 
	"DESCRIPTION" VARCHAR(60) NOT NULL
   );


   INSERT INTO ORDERS VALUES('100100', '1000.00', '600.00', '08/01/2001', 'C00013', 'A003', 'BAD');
INSERT INTO ORDERS VALUES('100110', '3000.00', '500.00', '04/15/2001', 'C00019', 'A010', 'GOOD');
INSERT INTO ORDERS VALUES('100107', '4500.00', '900.00', '08/30/2018', 'C00007', 'A010', 'GOOD');
INSERT INTO ORDERS VALUES('100112', '2000.00', '400.00', '05/30/2001', 'C00016', 'A007', 'GOOD'); 
INSERT INTO ORDERS VALUES('100113', '4000.00', '600.00', '06/10/2018', 'C00022', 'A002', 'GOOD');
INSERT INTO ORDERS VALUES('100102', '2000.00', '300.00', '05/25/2001', 'C00012', 'A012', 'EXCELLENT');
INSERT INTO ORDERS VALUES('100114', '3500.00', '2000.00', '08/15/2018', 'C00002', 'A008', 'GOOD');
INSERT INTO ORDERS VALUES('100122', '2500.00', '400.00', '09/16/2018', 'C00003', 'A004', 'GOOD');
INSERT INTO ORDERS VALUES('100118', '500.00', '100.00', '07/20/2018', 'C00023', 'A006', 'GOOD');
INSERT INTO ORDERS VALUES('100119', '4000.00', '700.00', '09/16/2018', 'C00007', 'A010', 'GOOD');
INSERT INTO ORDERS VALUES('100121', '1500.00', '600.00', '09/23/2018', 'C00008', 'A004', 'BAD');
INSERT INTO ORDERS VALUES('100130', '2500.00', '400.00', '07/30/2018', 'C00025', 'A011', 'GOOD');
INSERT INTO ORDERS VALUES('100134', '4200.00', '1800.00', '09/25/2018', 'C00004', 'A005', 'GOOD');
INSERT INTO ORDERS VALUES('100108', '4000.00', '600.00', '02/15/2018', 'C00008', 'A004', 'GOOD');
INSERT INTO ORDERS VALUES('100103', '1500.00', '700.00', '05/15/2014', 'C00021', 'A005', 'GOOD');
INSERT INTO ORDERS VALUES('100105', '2500.00', '500.00', '07/18/2018', 'C00025', 'A011', 'EXCELLENT');
INSERT INTO ORDERS VALUES('100109', '3500.00', '800.00', '07/30/2018', 'C00011', 'A010', 'GOOD');
INSERT INTO ORDERS VALUES('100101', '3000.00', '1000.00', '07/15/2018', 'C00001', 'A008', 'GOOD');
INSERT INTO ORDERS VALUES('100111', '1000.00', '300.00', '07/10/2013', 'C00020', 'A008', 'EXCELLENT');
INSERT INTO ORDERS VALUES('100104', '1500.00', '500.00', '03/13/2018', 'C00006', 'A004', 'GOOD');
INSERT INTO ORDERS VALUES('100106', '2500.00', '700.00', '04/20/2008', 'C00005', 'A002', 'GOOD');
INSERT INTO ORDERS VALUES('100125', '2000.00', '600.00', '10/10/2018', 'C00018', 'A005', 'BAD');
INSERT INTO ORDERS VALUES('100117', '800.00', '200.00', '10/20/2008', 'C00014', 'A001', 'GOOD');
INSERT INTO ORDERS VALUES('100123', '500.00', '100.00', '09/16/2018', 'C00022', 'A002', 'GOOD');
INSERT INTO ORDERS VALUES('100120', '500.00', '100.00', '07/20/2018', 'C00009', 'A002', 'EXCELLENT');
INSERT INTO ORDERS VALUES('100116', '500.00', '100.00', '07/13/2018', 'C00010', 'A009', 'GOOD');
INSERT INTO ORDERS VALUES('100124', '500.00', '100.00', '06/20/2008', 'C00017', 'A007', 'GOOD'); 
INSERT INTO ORDERS VALUES('100126', '500.00', '100.00', '06/24/2018', 'C00022', 'A002', 'BAD');
INSERT INTO ORDERS VALUES('100129', '2500.00', '500.00', '07/20/2018', 'C00024', 'A006', 'GOOD');
INSERT INTO ORDERS VALUES('100127', '2500.00', '400.00', '07/20/2018', 'C00015', 'A003', 'GOOD');
INSERT INTO ORDERS VALUES('100128', '3500.00', '1500.00', '07/20/2008', 'C00009', 'A002', 'GOOD');
INSERT INTO ORDERS VALUES('100135', '2000.00', '800.00', '09/16/2008', 'C00007', 'A010', 'GOOD');
INSERT INTO ORDERS VALUES('100131', '900.00', '150.00', '08/26/2008', 'C00012', 'A012', 'GOOD');
INSERT INTO ORDERS VALUES('100133', '1200.00', '400.00', '06/29/2018', 'C00009', 'A002', 'GOOD');


CREATE VIEW Fact_Orders
as 
(select *from dbo.ORDERS)


CREATE VIEW Dim_Customer
as 
(select *from dbo.CUSTOMER)


CREATE VIEW Dim_SalesPerson
as 
(select *from dbo.SALES_PERSON




create table dim_GeoLocation(
	   [name] nvarchar(50)
      ,[alpha-2] nvarchar(50)
      ,[alpha-3] nvarchar(50)
      ,[country-code] decimal(10,3)
      ,[iso_3166-2] nvarchar(50)
      ,[region] nvarchar(50)
      ,[sub-region] nvarchar(50)
      ,[intermediate-region] nvarchar(50)
      ,[region-code] nvarchar(50)
      ,[sub-region-code] decimal(10,3)
      ,[intermediate-region-code] decimal(10,3)

  );

  select *from dim_GeoLocation